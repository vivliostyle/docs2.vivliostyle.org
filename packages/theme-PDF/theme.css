/**
 * Vivliostyle PDF Theme
 * ドキュメントサイトからPDF生成するための専用テーマ
 * Web専用要素を自動的に除外し、印刷に適したレイアウトを提供
 */

/* ページ設定 */
@page {
  size: A4;
  margin: 25mm 20mm;
  
  @top-center {
    content: none;
  }
  
  @top-left {
    content: none;
  }
  
  @top-right {
    content: none;
  }
  
  @bottom-center {
    content: counter(page);
    font-size: 9pt;
  }
  
  @bottom-left {
    content: none;
  }
  
  @bottom-right {
    content: none;
  }
}

@page :first {
  margin-top: 50mm;
  
  @top-center {
    content: none;
  }
  
  @bottom-center {
    content: none;
  }
}

/* 基本スタイル */
:root {
  --color-text: #000000;
  --color-bg: #ffffff;
  --color-bg-code: #f0f0f0;
  --color-border: #cccccc;
  --font-size-base: 10pt;
}

* {
  box-sizing: border-box;
}

body {
  font-family: 'Noto Sans JP', 'Hiragino Sans', 'Hiragino Kaku Gothic ProN', 'Yu Gothic', sans-serif;
  font-size: var(--font-size-base);
  line-height: 1.7;
  color: var(--color-text);
  background: var(--color-bg);
  margin: 0;
  padding: 0;
}

/* Web専用要素を完全に削除 */
header.header,
nav.header-nav,
aside.sidebar,
.sidebar-overlay,
.mobile-menu-toggle,
.theme-toggle,
.search-container,
.lang-switcher,
.lang-switcher-mobile,
.language-switcher-container,
nav.breadcrumb,
.page-navigation,
.back-to-home,
.sidebar-mobile-controls,
.header-content,
.header-actions,
.sidebar-header,
.sidebar-close {
  display: none !important;
}

/* レイアウトをシンプル化 */
.layout,
.main-container,
.content,
.prose,
.docs-content {
  display: block !important;
  width: 100% !important;
  max-width: none !important;
  margin: 0 !important;
  padding: 0 !important;
}

/* 見出しスタイル */
h1 {
  font-size: 24pt;
  font-weight: bold;
  margin-top: 0;
  margin-bottom: 1.5em;
  page-break-after: avoid;
}

h2 {
  font-size: 18pt;
  font-weight: bold;
  margin-top: 2em;
  margin-bottom: 1em;
  page-break-after: avoid;
  border-bottom: 1px solid var(--color-border);
  padding-bottom: 0.3em;
}

h3 {
  font-size: 14pt;
  font-weight: bold;
  margin-top: 1.5em;
  margin-bottom: 0.8em;
  page-break-after: avoid;
}

h4 {
  font-size: 12pt;
  font-weight: bold;
  margin-top: 1.2em;
  margin-bottom: 0.6em;
  page-break-after: avoid;
}

h5, h6 {
  font-size: 10pt;
  font-weight: bold;
  margin-top: 1em;
  margin-bottom: 0.5em;
  page-break-after: avoid;
}

/* 段落 */
p {
  margin: 0.8em 0;
  text-align: justify;
}

/* インライン画像を含む段落は改行を抑制 */
p img[style*="width: 1.5em"],
p img[style*="width:1.5em"],
p img[width],
p img[height] {
  white-space: nowrap; /* 画像前後の改行を防ぐ */
}

/* リスト */
ul, ol {
  margin: 1em 0;
  padding-left: 2em;
}

li {
  margin: 0.3em 0;
}

/* コードブロック */
pre {
  background: var(--color-bg-code);
  border: 1px solid var(--color-border);
  border-radius: 4px;
  padding: 1em;
  overflow: auto;
  page-break-inside: avoid;
  margin: 1em 0;
  font-size: 9pt;
  line-height: 1.5;
}

code {
  font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
  background: var(--color-bg-code);
  padding: 0.2em 0.4em;
  border-radius: 3px;
  font-size: 0.9em;
}

pre code {
  background: none;
  padding: 0;
  border-radius: 0;
}

/* 引用 */
blockquote {
  border-left: 4px solid var(--color-border);
  padding-left: 1em;
  margin: 1em 0;
  color: #666;
  page-break-inside: avoid;
}

/* テーブル */
table {
  width: 100%;
  border-collapse: collapse;
  margin: 1em 0;
  page-break-inside: avoid;
  font-size: 9pt;
}

th, td {
  border: 1px solid var(--color-border);
  padding: 0.5em;
  text-align: left;
}

th {
  background: #f5f5f5;
  font-weight: bold;
}

/* リンク */
a {
  color: var(--color-text);
  text-decoration: none;
  border-bottom: 1px dotted #999;
}

a[href^="http"]::after {
  content: " (" attr(href) ")";
  font-size: 0.8em;
  color: #666;
  word-break: break-all;
}

/* インライン画像（width/height属性を持つ画像、またはstyleでwidthを指定している小さな画像）*/
img[width],
img[height],
img[style*="width: 1.5em"],
img[style*="width:1.5em"] {
  display: inline !important;
  margin: 0 !important;
  padding: 0 !important;
  border: 0 !important;
  vertical-align: text-bottom !important;
  max-width: none !important;
  width: auto !important;
  height: 1em !important;
  line-height: 0 !important;
  font-size: inherit !important;
}

/* float指定のある画像 - 右寄せで天地いっぱいに表示、テキストの回り込み */
img[style*="float"][alt="設定パネル"],
img[style*="float right"] {
  float: right !important;
  max-width: 50% !important;
  width: auto !important;
  height: 200mm !important;
  max-height: 200mm !important;
  margin: 0.5em 0 0.5em 1em !important;
  clear: none !important;
  object-fit: contain !important;
  display: block !important;
}

/* float画像の直後のul要素 - floatの回り込みを有効にする */
img[style*="float"] + ul,
img[style*="float right"] + ul {
  overflow: hidden !important;  /* 新しいブロック整形コンテキストを作成 */
  display: flow-root !important; /* より明示的なfloat対応 */
}

/* 画像 - デフォルト */
img {
  max-width: 100% !important;
  height: auto !important;
  object-fit: contain;
  page-break-inside: avoid;
}

/* その他のブロック画像 */
img:not([width]):not([height]):not([style*="float"]) {
  display: block !important;
  float: none !important;
  max-width: 100% !important;
  width: auto !important;
  margin: 1em auto !important;
}

/* 水平線 */
hr {
  border: none;
  border-top: 1px solid var(--color-border);
  margin: 2em 0;
}

/* ページブレーク制御 */
.page-break-before {
  page-break-before: always;
}

.page-break-after {
  page-break-after: always;
}

.avoid-break {
  page-break-inside: avoid;
}

/* セクション */
section {
  margin-bottom: 2em;
}

/* 定義リスト */
dt {
  font-weight: bold;
  margin-top: 1em;
}

dd {
  margin-left: 2em;
  margin-bottom: 0.5em;
}
